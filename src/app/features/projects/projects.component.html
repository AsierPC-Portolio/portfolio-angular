<div class="mb-4 flex flex-col md:flex-row md:items-center gap-2">
  <ui-input
    id="filter"
    [label]="''"
    [placeholder]="'projects.filter' | translate"
    [ngModel]="filter()"
    (ngModelChange)="filter.set($event); onFilterChange()"
  ></ui-input>
  <ui-button color="primary" (click)="openNewProject()" (keydown.enter)="openNewProject()">{{ 'projects.new' | translate }}</ui-button>
</div>

<ui-table
  [columns]="columns"
  [data]="projects()"
  [loading]="loading()"
  [page]="page()"
  [size]="size()"
  [total]="total()"
  [sort]="sort()"
  (sortChange)="sort.set($event); load()"
  (pageChange)="onPageChange($event)"
>
  <ng-template #rowActions let-project>
    <div class="flex justify-center items-center gap-2">
        <button type="button" (click)="openEditProject(project)" class="p-1 rounded hover:bg-gray-100 focus:outline-none" [attr.aria-label]="'common.edit' | translate">
            <ng-icon name="heroPencil" size="18" class="text-blue-600" />            
        </button>
        <button type="button" (click)="askDeleteProject(project)" class="p-1 rounded hover:bg-red-100 focus:outline-none ml-1" [disabled]="deletingId() === project.id" [attr.aria-label]="'common.delete' | translate">
            <ng-icon name="heroTrash" size="18" class="text-red-600" />
        </button>
    </div>
  </ng-template>
</ui-table>

<app-project-form
  [open]="showForm()"
  [project]="editingProject()"
  (close)="closeForm()"
  (saved)="onProjectSaved()"
></app-project-form>

<ui-modal [open]="!!confirmDeleteProject()" [title]="'projects.deleteTitle' | translate" (close)="cancelDeleteProject()">
  <div *ngIf="confirmDeleteProject() as project">
    <p class="mb-4">{{ 'projects.deleteConfirm' | translate:{ name: project.name } }}</p>
    <div class="flex justify-end gap-2">
      <ui-button color="secondary" (click)="cancelDeleteProject()" (keydown.enter)="cancelDeleteProject()">{{ 'common.cancel' | translate }}</ui-button>
      <ui-button color="danger" [loading]="deletingId() === project.id" (click)="deleteProjectConfirmed()" (keydown.enter)="deleteProjectConfirmed()">{{ 'common.delete' | translate }}</ui-button>
    </div>
  </div>
</ui-modal>